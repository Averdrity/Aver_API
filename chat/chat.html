<!-- File: chat.html -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#1e1e1e" />
  <title>Aver AI â€“ Chat</title>

  <!-- Favicon & Icons -->
  <link rel="icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" href="/assets/aw_touch_icon_180x180.png" sizes="180x180" />
  <link rel="manifest" href="/manifest.json" />

  <!-- Stylesheet -->
  <link rel="stylesheet" href="/css/style.css" />
</head>

<body>

  <!-- Dynamic Floating Header Mount Point -->
  <div id="headerMountPoint"></div>

  <!-- Main Chat Layout -->
  <main class="chat-page">

    <!-- Left Sidebar (Saved Chats) -->
    <aside class="sidebar">
      <input type="text" id="chatSearch" class="sidebar-search" placeholder="ðŸ” Search chats..." />
      <button id="newChatBtn" class="sidebar-btn">ðŸ†• New Chat</button>
      <div id="chatHistory" class="chat-history">
        <!-- Dynamically loaded chat history -->
      </div>
    </aside>

    <!-- Center Chat Section -->
    <section class="chat-section">
      <div class="chat-header">
        <h2 id="chatSessionTitle" class="animated fadeIn">âœ¨ AI Chat Session</h2>
      </div>
      <div id="chatBox" class="chat-box">
        <!-- AI and User messages dynamically injected here -->
      </div>

      <!-- Hidden form integrated with modular chatbox-modal -->
      <form id="chatForm" class="hidden-form" style="display:none;">
        <input type="hidden" id="chatInput" />
      </form>
    </section>

    <!-- Right Sidebar (Memory Cards) -->
    <aside class="memory-sidebar">
      <div class="memory-tools">
        <input type="text" id="memorySearch" placeholder="ðŸ” Search memories..." />
        <button id="clearAllMemoriesBtn" title="Clear All Memories">ðŸ§¹</button>
      </div>
      <div id="memoryList" class="memory-list">
        <!-- Dynamically loaded memory cards -->
      </div>
    </aside>

  </main>

  <!-- Dynamic Footer Mount Point -->
  <div id="footerMountPoint"></div>

  <!-- JavaScript Modules -->
  <script type="module">
    import { injectHeaderFooter } from '/js/injectHeaderFooter.js';
    import { initThemeToggle } from '/js/themeToggle.js';
    import { initChatboxModal } from '/js/chatbox-modal.js';
    import '/js/chat.js';
    import '/js/logger.js';

    // Inject header/footer and dynamically adjust header buttons (AI Chatâ†’Home)
    injectHeaderFooter('chat');

    // Initialize persistent theme toggle (Dark/Light Mode)
    initThemeToggle();

    // Initialize modular Chatbox modal input
    initChatboxModal(async (message) => {
      document.getElementById("chatInput").value = message;
      document.getElementById("chatForm").dispatchEvent(new Event("submit"));
    });
  </script>

</body>
</html>
